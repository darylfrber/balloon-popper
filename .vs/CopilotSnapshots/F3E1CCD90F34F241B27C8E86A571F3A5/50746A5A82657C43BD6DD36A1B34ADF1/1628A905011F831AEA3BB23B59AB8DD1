using UnityEngine;

public class Balloon : MonoBehaviour
{
    public float riseSpeed = 1f;
    public int scoreValue = 10;
    public PowerUpDropper powerUpDropper;

    private bool popped;
    private SpriteRenderer sr;

    void Awake(){ sr = GetComponent<SpriteRenderer>(); if(sr==null) sr = gameObject.AddComponent<SpriteRenderer>(); }
    void OnEnable(){ popped=false; if(sr!=null){ sr.sprite = RuntimeArtFactory.GetCircleSprite(64, Random.ColorHSV(0f,1f,0.6f,1f,0.8f,1f)); transform.localScale = Vector3.one * Random.Range(0.7f,1.2f); } }

    void Update(){ if(!popped){ transform.Translate(Vector3.up * riseSpeed * Time.deltaTime); if(transform.position.y > 6f) { Recycle(); } } }

    public void Pop(){ if(popped) return; popped = true; GameManager.Instance.AddScore(scoreValue); if(powerUpDropper!=null) powerUpDropper.TryDrop(transform.position); // TODO: particle/audio
        Recycle(); }

    void Recycle(){ popped=false; gameObject.SetActive(false); }
}
